# Traffic Light Controller - Version 1
This project demonstrates a simple PID (Proportional-Integral-Derivative) controller implemented in C++.

## Features of the project:
1. PID Controller Implementation: The project provides a complete implementation of a PID (Proportional-Integral-Derivative) controller in C++, allowing users to control systems based on feedback.

2. Modular Architecture: The project is structured with a modular architecture, separating the PID controller logic into its own class (`PIDController`). This design promotes code reusability and maintainability.
 
3. Flexibility in Tuning: Users can easily tune the PID controller by adjusting the proportional (Kp), integral (Ki), and derivative (Kd) constants according to the requirements of their specific system.
 
4. Example Usage: The `main.cpp` file in the `examples/` directory provides an example of how to use the PID controller class. Users can reference this example to understand how to integrate the PID controller into their own projects.
 
5. Data Logging: The example program logs the output of the PID controller, including the process variable (PV) and PID output, to a CSV file (`output_data.csv`). This allows users to analyze the performance of the controller over time.
 
6. Visualization: The project includes a Gnuplot script (`plot_script.gp`) that automatically generates a plot of the PID controller output based on the data logged in `output_data.csv`. This visualization helps users understand how well the controller is performing.

7. Ease of Use: With the provided Makefile, users can easily compile the project and run the example program without needing to manually configure build settings.

8. Portability: The project is written in C++, making it portable across different platforms and environments. Users can compile and run the code on various operating systems with minimal changes.

9. Documentation and Licensing: The project includes a README.md file that provides detailed instructions for building and running the project, as well as information about licensing and contributing. This documentation helps users understand the project and its usage.

## Model-based Diagram:

Model-based diagram for the PID controller project can help visualize the structure and flow of the system. Below are key components and interactions depicted in the diagram:
- PIDController Class: This is the core class implementing the PID control logic.
- Main Program: The main function that initializes the PIDController, runs the control loop, and generates output files.
- Data File (output_data.csv): The file where the PID output data is logged.
- Gnuplot Script (plot_script.gp): The script for plotting the data using Gnuplot.
- Output Plot (pid_output.png): The generated plot showing the PID controller output.

<img width="215" alt="Screenshot 2024-05-30 at 10 03 21 PM" src="https://github.com/MenakaGodakanda/PIDControllerProject/assets/156875412/3cf52ac4-aef9-419c-80d3-98994c9e90ff"><br>

In this diagram:
1. Main Program (examples/main.cpp):
- Initializes the PIDController with parameters (Kp, Ki, Kd).
- Runs a loop where the PID computation is performed.
- Logs data (process variable and PID output) to `output_data.csv`.
- Generates a Gnuplot script (`plot_script.gp`) to plot the logged data.
- Executes the Gnuplot script to produce `pid_output.png`.

2. PIDController Class (src/PIDController.cpp):
- Contains the PID control logic.
- Computes the control output based on the setpoint and process variable.
- Provides methods for setting parameters and computing the control output.

3. Output Data File (output_data.csv):
- Stores the iteration number, process variable, and PID output.
- Is generated by the main program and read by Gnuplot for plotting.

4. Gnuplot Script (plot_script.gp):
- Script generated by the main program.
- Contains commands to plot the data from `output_data.csv`.
- Produces the output plot `pid_output.png`.

5. Output Plot File (pid_output.png):
- Visual representation of the PID controller output over time.
- Generated by executing the Gnuplot script.

## Project Structure:
<img width="723" alt="Screenshot 2024-05-30 at 9 38 42 PM" src="https://github.com/MenakaGodakanda/PIDControllerProject/assets/156875412/46b32f18-7e14-480f-bc7d-c9a5e68376fc"><br>

## Coding Details:
This project implements a PID controller in C++. It consists of:
- PIDController Class: Implements the PID control logic.
- Main Program: Demonstrates the usage of the PIDController, logs output data to a CSV file, and generates a Gnuplot script to plot the data.

### Header File (PIDController.h)
#### PIDController Class: This defines the interface for the PID controller.
  - Public Methods:
    - `PIDController(double kp, double ki, double kd)`: Constructor to initialize the PID parameters.
    - `double compute(double setpoint, double pv)`: Computes the PID output based on the setpoint and process variable (pv).
  - Private Members:
    - `double Kp, Ki, Kd`: PID constants for proportional, integral, and derivative terms.
    - `double prev_error`: Stores the error from the previous computation for the derivative term.
    - `double integral`: Accumulates the integral of the error over time.

### PIDController Implementation (PIDController.cpp)
  - Constructor: Initializes the PID constants and sets initial values for `prev_error` and `integral`.
  - Compute Method:
    - Error Calculation: Computes the error as the difference between the setpoint and the process variable (pv).
    - Integral Calculation: Accumulates the error over time.
    - Derivative Calculation: Computes the change in error from the previous error.
    - PID Output: Computes the PID output as the sum of the proportional, integral, and derivative terms.

### Main Program (main.cpp)
  - Initialization:
    - Creates an instance of `PIDController` with specified PID constants.
    - Sets the `setpoint` (desired value) and initial `pv` (process variable).

  - Data Logging:
    - Opens a CSV file (`output_data.csv`) to log the data.
    - Checks if the file is successfully created, otherwise prints an error.

  - PID Computation Loop:
    - Runs a loop for a specified number of iterations (100 in this case).
    - In each iteration, it:
      - Computes the PID output using `pid.compute(setpoint, pv)`.
      - Updates the process variable (`pv`) by adding the PID output to simulate the system's response.
      - Logs the iteration number, process variable, and PID output to the CSV file.

  - Gnuplot Script Generation:
    - Creates a Gnuplot script (`plot_script.gp`) to plot the data from the CSV file.
    - Specifies the output format (PNG), output file (`pid_output.png`), plot title, axis labels, grid, and data format (CSV).
    - Plots two lines: one for the process variable (PV) and one for the PID output.

  - Execute Gnuplot Script:
    - Executes the Gnuplot script using the `system` command to generate the plot (`pid_output.png`).
    - Checks if the Gnuplot command executes successfully, otherwise prints an error.

### Summary
This project demonstrates the complete flow of a PID controller system:
- Initialization: Setting up the PID controller with appropriate constants.
- Computation: Running a control loop to compute and update the process variable based on the PID output.
- Logging: Storing the computed data in a CSV file for later analysis.
- Visualization: Generating a plot using Gnuplot to visualize the performance of the PID controller.
